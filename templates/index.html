<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Proxy Browser</title>
<style>
body{margin:0;font-family:sans-serif;background:#121212;color:#eee;}
body.light{background:#f5f5f5;color:#111;}
header{display:flex;flex-direction:column;}
.tab-bar{display:flex;overflow-x:auto;background:#1e1e1e;}
.tab{padding:6px 12px;cursor:pointer;border-right:1px solid #333;}
.tab.active{background:#3d8bfd;color:#fff;}
.tab button{margin-left:4px;background:transparent;border:none;color:inherit;cursor:pointer;}
.controls{display:flex;align-items:center;gap:6px;padding:6px;background:#222;}
.controls button{background:#3d8bfd;color:white;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;}
.controls input{flex:1;padding:5px;border-radius:5px;border:1px solid #333;background:#121212;color:#eee;}
iframe{width:100%;height:calc(100vh-100px);border:none;}
.bookmark-list{position:absolute;top:50px;right:10px;background:#222;border:1px solid #333;border-radius:6px;padding:6px;display:none;flex-direction:column;}
.bookmark-list.visible{display:flex;}
.bookmark-list button{background:none;border:none;text-align:left;padding:6px;color:#eee;cursor:pointer;}
.bookmark-list button:hover{background:#3d8bfd;color:white;}
</style>
</head>
<body>
<header>
<div class="tab-bar" id="tabBar"></div>
<div class="controls">
<button onclick="goBack()">‚Üê</button>
<button onclick="goForward()">‚Üí</button>
<button onclick="reload()">‚ü≥</button>
<input id="urlInput" placeholder="URL„ÇíÂÖ•Âäõ" onkeydown="if(event.key==='Enter') loadURL()"/>
<button onclick="addBookmark()">‚òÜ</button>
<button onclick="toggleBookmarks()">üìë</button>
<button onclick="toggleTheme()">üåó</button>
</div>
</header>
<div class="bookmark-list" id="bookmarkList"></div>
<iframe id="browserView"></iframe>
<script>
let tabs=[{url:''}],currentTab=0,historyStack=[[]],forwardStack=[[]];
const iframe=document.getElementById('browserView'),urlInput=document.getElementById('urlInput'),tabBar=document.getElementById('tabBar'),bookmarkList=document.getElementById('bookmarkList');
function loadURL(url){if(!url)url=urlInput.value;if(!url.startsWith('http'))url='https://'+url;const proxyUrl='/proxy?url='+encodeURIComponent(url);iframe.src=proxyUrl;tabs[currentTab].url=url;historyStack[currentTab].push(url);urlInput.value=url;saveState();}
function goBack(){if(historyStack[currentTab].length>1){const url=historyStack[currentTab].splice(-2,1)[0];forwardStack[currentTab].push(tabs[currentTab].url);loadURL(url);}}
function goForward(){if(forwardStack[currentTab].length>0){const url=forwardStack[currentTab].pop();loadURL(url);}}
function reload(){if(tabs[currentTab].url)loadURL(tabs[currentTab].url);}
function newTab(){tabs.push({url:''});historyStack.push([]);forwardStack.push([]);updateTabs();switchTab(tabs.length-1);}
function closeTab(e,i){e.stopPropagation();tabs.splice(i,1);historyStack.splice(i,1);forwardStack.splice(i,1);if(currentTab>=tabs.length)currentTab=tabs.length-1;updateTabs();if(tabs[currentTab])loadURL(tabs[currentTab].url);}
function switchTab(i){currentTab=i;updateTabs();const t=tabs[i];iframe.src=t.url?'/proxy?url='+encodeURIComponent(t.url):'';urlInput.value=t.url||'';}
function updateTabs(){tabBar.innerHTML='';tabs.forEach((t,i)=>{const tabEl=document.createElement('div');tabEl.className='tab'+(i===currentTab?' active':'');tabEl.innerHTML=(t.url?t.url.replace(/^https?:\/\//,''):'Êñ∞Ë¶è„Çø„Éñ')+`<button onclick="closeTab(event,${i})">√ó</button>`;tabEl.onclick=()=>switchTab(i);tabBar.appendChild(tabEl);});const addBtn=document.createElement('button');addBtn.textContent='Ôºã';addBtn.onclick=newTab;tabBar.appendChild(addBtn);}
function addBookmark(){const url=tabs[currentTab].url;if(!url)return;const b=JSON.parse(localStorage.getItem('bookmarks')||'[]');if(!b.includes(url))b.push(url);localStorage.setItem('bookmarks',JSON.stringify(b));renderBookmarks();}
function toggleBookmarks(){bookmarkList.classList.toggle('visible');renderBookmarks();}
function renderBookmarks(){const b=JSON.parse(localStorage.getItem('bookmarks')||'[]');bookmarkList.innerHTML='';b.forEach(u=>{const btn=document.createElement('button');btn.textContent=u.replace(/^https?:\/\//,'');btn.onclick=()=>{loadURL(u);bookmarkList.classList.remove('visible');};bookmarkList.appendChild(btn);});}
function toggleTheme(){document.body.classList.toggle('light');localStorage.setItem('theme',document.body.classList.contains('light')?'light':'dark');}
function saveState(){localStorage.setItem('tabs',JSON.stringify(tabs));localStorage.setItem('currentTab',currentTab);}
function restoreState(){const t=JSON.parse(localStorage.getItem('tabs')||'[{"url":""}]'),c=parseInt(localStorage.getItem('currentTab')||'0');tabs=t;currentTab=c;updateTabs();if(tabs[currentTab].url)loadURL(tabs[currentTab].url);const theme=localStorage.getItem('theme');if(theme==='light')document.body.classList.add('light');}
restoreState();
</script>
</body>
</html>
